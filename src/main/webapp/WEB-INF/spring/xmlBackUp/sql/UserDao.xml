<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.recipe.dao.UserDao">

	<resultMap type="user" id="userMap">
		<id column="id" property="userId" />
		<result column="password" property="userPassword" />
		<result column="name" property="userName" />
		<result column="phoneNumber" property="userPhoneNumber" />
		<result column="birth" property="userBirth" />
		<result column="code" property="userCode" />
	</resultMap>
	
	<!-- 
		private String userId;
	private String userPassword;
	private String userName;
	private String userPhoneNumber;
	private String userBirth;
	private int userCode;
	 -->

    <!-- 로그인  -->
	
	<select id="selectUser" resultMap="userMap" parameterType="string">
		SELECT * FROM user
	</select>


	<insert id="insertUser" parameterType="user">
		insert into users(name, email,
		pwd, role, join_dt,auth_key,auth, img)
		values ( #{userName}, #{email},
		#{password},
		'user', now(),#{authenticationKEY},#{authentication}, #{image})
	</insert>

	<update id="update" parameterType="user">
		UPDATE users
		<set>
			<if test="password != '' and password != null">pwd = #{password},</if>
			<if test="intro != '' and intro != null">intro = #{intro},</if>
			img = #{image}
		</set>
		WHERE uno = #{userNo}
	</update>

	<insert id="addUserInNaver" parameterType="user">
		insert into users(name,email,pwd,img,role,join_dt,auth_key,auth) values
		(#{userName}, #{email},0,'default.jpg','user',now(),null,0);
	</insert>

	<update id="authUpdate" parameterType="user">
		UPDATE users
		SET auth=#{auth}
		WHERE email = #{inputEmail}
	</update>

	<update id="updateHits" parameterType="int">
		UPDATE users
		SET hits=hits+1
		WHERE uno = #{value}
	</update>
</mapper>